训练集样本数: 8528
测试集样本数: 2133
Epoch 1/20, Loss: 0.6717
Train Accuracy: 0.5867
Test Accuracy: 0.6910
Epoch 2/20, Loss: 0.6074
Train Accuracy: 0.6853
Test Accuracy: 0.7829
Epoch 3/20, Loss: 0.5598
Train Accuracy: 0.7360
Test Accuracy: 0.8059
Epoch 4/20, Loss: 0.5154
Train Accuracy: 0.7683
Test Accuracy: 0.8073
Epoch 5/20, Loss: 0.4869
Train Accuracy: 0.7851
Test Accuracy: 0.8176
Traceback (most recent call last):
  File "/home/wuwen/python_project/nlp2/main.py", line 100, in <module>
    train(args)
  File "/home/wuwen/python_project/nlp2/main.py", line 83, in train
    trained_model = trainer.trainer(device, model, optimizer, criterion, train_dataloader, test_dataloader, bert, args.epochs)
  File "/home/wuwen/python_project/nlp2/trainer.py", line 15, in trainer
    for input_ids, attention_mask, labels in train_dataloader:
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/wuwen/python_project/nlp2/model_data.py", line 72, in <lambda>
    train_dataset, batch_size=batch_size, shuffle=True, collate_fn=lambda batch: collate_fn(batch, tokenizer))
  File "/home/wuwen/python_project/nlp2/model_data.py", line 26, in collate_fn
    encodings = tokenizer(list(texts),
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 3021, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 3109, in _call_one
    return self.batch_encode_plus(
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 3311, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils.py", line 888, in _batch_encode_plus
    first_ids = get_input_ids(ids)
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils.py", line 855, in get_input_ids
    tokens = self.tokenize(text, **kwargs)
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/tokenization_utils.py", line 698, in tokenize
    tokenized_text.extend(self._tokenize(token))
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/models/bert/tokenization_bert.py", line 161, in _tokenize
    for token in self.basic_tokenizer.tokenize(
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/models/bert/tokenization_bert.py", line 339, in tokenize
    text = self._clean_text(text)
  File "/home/wuwen/miniconda3/envs/cs224n_dfp/lib/python3.8/site-packages/transformers/models/bert/tokenization_bert.py", line 446, in _clean_text
    output.append(char)
KeyboardInterrupt
